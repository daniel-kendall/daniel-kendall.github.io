<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Southern Haven Hotels — Reservation</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="base.css">
</head>

<body>
  <main class="container" role="main">
    <section class="hero" aria-labelledby="hero-heading">
      <div>
        <div class="logo">
          <div class="mark">SH</div>
          <div>
            <div style="font-size:13px;color:var(--muted);letter-spacing:1px">ROO ROOMS</div>
            <div style="font-weight:600;color:var(--accent-deep);font-size:12px">Luxury Hotels & Retreats — Australia</div>
          </div>
        </div>

        <h1 id="hero-heading">Arrive in style. Stay in comfort.</h1>
        <p class="lead">Experience Australia from the comfort of refined spaces — coastal suites, city sanctuaries and remote retreats curated with artful design, native warmth and impeccable service.</p>

        <div class="features" aria-hidden="true">
          <div class="feature"><strong>Private Beach Access</strong><small>Exclusive coastal locations</small></div>
          <div class="feature"><strong>Spa & Wellness</strong><small>Indigenous-inspired treatments</small></div>
          <div class="feature"><strong>Seasonal Dining</strong><small>Local produce & fine wine</small></div>
        </div>
      </div>

      <!-- decorative leaf -->
      <svg class="leaf" width="380" height="380" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <g fill="none" stroke="black" stroke-width="1" transform="translate(10,10)">
          <path d="M10 100 C40 10, 160 10, 190 100 C160 190, 40 190, 10 100 Z" fill="#0b6b4a" opacity="0.9"></path>
        </g>
      </svg>

      <footer class="branding">
        <small>From Sydney to the Red Centre — crafted stays.</small>
      </footer>
    </section>

    <aside class="card" aria-labelledby="form-heading">
      <h2 id="form-heading" style="margin:0 0 8px;font-family:'Playfair Display',serif;color:var(--accent-deep);">Book your stay</h2>
      <p class="muted" style="margin-top:0;margin-bottom:12px">Luxury rooms · Flexible rates · Complimentary concierge</p>

      <form id="bookingForm" novalidate onsubmit="return false;">
        <div>
          <label for="name">Name</label>
          <input id="name" name="name" type="text" placeholder="Alex Morgan" required>
        </div>

        <div>
          <label for="email">Email</label>
          <input id="email" name="email" type="email" placeholder="alex@example.com" required>
        </div>

        <div>
          <label for="mobile">Mobile Number</label>
          <input id="mobile" name="mobile" type="tel" placeholder="+61 4xx xxx xxx" pattern="^\+?61[0-9\s()-]{8,}$" required>
          <div class="note" id="mobileNote">We'll send a confirmation SMS. Format will be normalised to +61.</div>
        </div>

        <div class="row">
          <div class="col">
            <label for="checkin">Check In Date</label>
            <input id="checkin" name="checkin" type="date" required>
          </div>
          <div class="col">
            <label for="checkout">Check Out Date</label>
            <input id="checkout" name="checkout" type="date" required>
          </div>
        </div>

        <div>
          <label for="location">Location</label>
          <select id="location" name="location" required>
            <option value="">Select a location</option>
            <option>Sydney</option>
            <option>Melbourne</option>
            <option>Brisbane</option>
            <option>Perth</option>
            <option>Adelaide</option>
            <option>Hobart</option>
            <option>Darwin</option>
            <option>Byron Bay</option>
            <option>Alice Springs</option>
            <option>Broome</option>
          </select>
        </div>

        <div class="actions">
          <button type="submit" class="btn">Check availability</button>
          <button type="button" class="btn ghost" id="clearBtn">Clear</button>
        </div>

        <p class="note" id="formMessage" role="status" aria-live="polite" style="margin-top:10px"></p>
      </form>
    </aside>
  </main>

  <script>
    console.log("Booking form script loaded ✅");
  
    const form = document.getElementById("bookingForm");
    const message = document.getElementById("formMessage");
  
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      message.textContent = "Sending your booking request...";
      message.style.color = "var(--accent-deep)";
  
      // Collect all form fields safely
      const formData = new FormData(form);
      const payload = Object.fromEntries(formData.entries());
  
      console.log("Payload being sent:", payload);
  
      try {
        const res = await fetch("/api/klaviyo-booking", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
  
        const data = await res.json();
        console.log("Server response:", data);
  
        if (!res.ok) {
          throw new Error(data.error || "Unknown error");
        }
  
        message.style.color = "green";
        message.textContent = "✅ Booking received! You’ll receive an email confirmation shortly.";
        form.reset();
      } catch (err) {
        console.error("Booking submission failed:", err);
        message.style.color = "red";
        message.textContent = "❌ There was an issue submitting your booking.";
      }
    });
  </script>  
</body>
</html>
